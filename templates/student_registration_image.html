{% extends 'base.html' %}

{% load static %}

{% block content %}
{% load crispy_forms_tags %}
{{ form.media.js }}
{{ form.media }}

<div class="container">
  <div id="my_camera"></div>
  <input type=button value="Take Snapshot" onClick="take_snapshot()">
  <div id="results" name="image_cam"></div>

  <form action="" method="post" class="dropzone" enctype="multipart/form-data">
    {% csrf_token %}
    <input value="Save Snapshot" onClick="take_snapshot()" name="file" type="file" accept="image/*;capture=camera">
    <button type="submit" class="btn btn-primary">Submit</button>
  </form>
  
  <input type=button value="Save Snapshot" onClick="saveSnap()">
</div>  





{% endblock content %}


{% block script %}
<script src="{% static 'js/webcam.min.js' %}" type="text/javascript"></script>
<script src="{% static 'js/dropzone.js' %}" type="text/javascript"></script>
<script>
Webcam.set({
  width: 320,
  height: 240,
  image_format: 'jpeg',
  jpeg_quality: 90
 });
 Webcam.attach( '#my_camera' );


 var shutter = new Audio();
 shutter.autoplay = false;
 shutter.src = navigator.userAgent.match(/Firefox/) ? 'shutter.ogg' : 'shutter.mp3';

 function take_snapshot() {
  // play sound effect
  shutter.play();

  // take snapshot and get image data
  Webcam.snap( function(data_uri) {
  // display results in page
  document.getElementById('results').innerHTML = 
   '<img id="imageprev" src="'+data_uri+'"/>';
  } );

  
 }

 function saveSnap(){
 
 var base64image = document.getElementById("imageprev").src;

 Webcam.upload( base64image, '/attendance/save_image/1', function(code, text) {
  
 });

}


</script>

{% endblock script %}
  